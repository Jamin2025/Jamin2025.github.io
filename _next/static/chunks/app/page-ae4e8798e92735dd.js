(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2241:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});class r{get size(){return this.heap.length}insert(e){this.heap.push(e),this.heapifyUp(this.size-1)}extractMax(){if(0===this.size)return null;if(1===this.size)return this.heap.pop();let e=this.heap[0];return this.heap[0]=this.heap.pop(),this.heapifyDown(0),e}heapifyUp(e){if(0===e)return;let t=Math.floor((e-1)/2);this.lager(this.heap[e],this.heap[t])&&(this.swap(t,e),this.heapifyUp(t))}lager(e,t){return e>t}inBound(e){return e<this.size}heapifyDown(e){let t=2*e+1,s=2*e+2,r=e;this.inBound(t)&&this.lager(this.heap[t],this.heap[r])&&(r=t),this.inBound(s)&&this.lager(this.heap[s],this.heap[r])&&(r=s),r!==e&&(this.swap(r,e),this.heapifyDown(r))}swap(e,t){let s=this.heap[e];this.heap[e]=this.heap[t],this.heap[t]=s}constructor(e){this.heap=[],this.comparator&&(this.lager=e)}}let i=r},3411:(e,t,s)=>{"use strict";let{coreNums:r,Core:i}=s(4477),a=s(9188),n=s(3604);class o{brokeCore(e){this.cores[e].broke()}getSortedCoresByLoad(){return[...this.cores].sort((e,t)=>e.load-t.load)}switchScheduleMode(e){this.cores.forEach(t=>t.switchScheduleMode(e))}async graphAppShedule(e,t){e=n(e);let s=[],r=new Set,i=new Set(e);for(;i.size;){for(let n of i)if(!n.complete&&n.predecessors.every(t=>e[t].complete)){i.delete(n);let e=t(new a(n.id,n.duration)).then(t=>(n.complete=!0,r.delete(e),t));r.add(e),s.push(e)}r.size&&await Promise.race([...r])}return await Promise.all(s)}runOnDistinctCores(e,t,s){let i=t instanceof Set;if(i&&4===t.size||i&&r-t.size<e)return{freeCores:[],callArr:[],noMoreCore:!0};let a=[],n=[],o=this.getSortedCoresByLoad(),l=i?o.filter(e=>!t.has(e.id)):o;for(let t=0;t<e;t++){let e=l[t];a.push(e.id),n.push(e.calculate({...s}))}return{callCores:a,callArr:n}}executeTask(e){let t=this.getSortedCoresByLoad()[0];return[t.calculate({...e}),t.id]}getExecutedTaskNum(){return this.cores.reduce((e,t)=>e+t.calCount,0)}constructor(e,t,s){this.cores=Array(r),this.NodeID=null;let{cores:a}=this;this.NodeID=e;for(let e=0;e<r;e++)a[e]=new i(e,t,s);Object.freeze(this.cores)}}o.mode_FCFS="FCFS",o.mode_LTF="LTF",o.FT={TMR_with_fault_core:(e,t,s,r)=>e==t?[e,r[2]]:e==s?[s,r[1]]:t==s?[t,r[0]]:[-1,r],TMR:(e,t,s)=>e==t?e:e==s?s:t==s?t:-1,TPTMR_Primary:(e,t)=>e==t?e:"TPTMPnoPass"},e.exports=o},3481:e=>{"use strict";let t=e=>{let t=1;for(let s=2;s<=e;s++)t*=s;return t};e.exports={hitProbability:function(e){return Math.random()<e},calProbability:function(e){return 1-function(e,s){let r=Math.E;return r**-e*1/t(0)}(.001*e,0)}}},3604:e=>{"use strict";e.exports=function e(t){if(null===t||"object"!=typeof t)return t;if(Array.isArray(t))return t.map(t=>e(t));let s={};for(let r in t)t.hasOwnProperty(r)&&(s[r]=e(t[r]));return s}},4477:(e,t,s)=>{"use strict";let{hitProbability:r}=s(3481),i=s(2241).A;function a(e,t){return e.duration>t.duration}class n{switchScheduleMode(e){this.scheduleMode=e}deactiveCore(){this.active_=!1}active(){this.active_=!0}promiseCalculate(e){return this.isCalculating=!0,"function"==typeof this.startExec&&this.startExec(this.id),new Promise(t=>{setTimeout(()=>{this.isNormalOperate()&&!r(e.transientFaultProbality)?e.result=.5:e.result=Math.random(),this.isCalculating=!1,"function"==typeof this.endExec&&this.endExec(this.id,this.isPermentFault),t(e.result)},10)})}auxFCFSCalculate(){if(this.scheduleQueue.length){let e=this.scheduleQueue.shift();this.promiseCalculate(e).then(t=>{this.load-=e.duration,this.auxFCFSCalculate(),e.resolve(t)})}}auxLTFCalculate(){if(this.scheduleHeap.size){let e=this.scheduleHeap.extractMax();this.promiseCalculate(e).then(t=>{this.load-=e.duration,this.auxLTFCalculate(),e.resolve(t)})}}calculate(e){return this.calCount++,new Promise(t=>{this.load+=e.duration,e.resolve=t,"FCFS"===this.scheduleMode?(this.scheduleQueue.push(e),this.isCalculating||this.auxFCFSCalculate()):(this.scheduleHeap.insert(e),this.isCalculating||this.auxLTFCalculate())})}isCalculating(){return this.isCalculating}isNormalOperate(){return!this.isPermentFault}broke(){this.isPermentFault=!0}constructor(e,t,s){this.isPermentFault=!1,this.isCalculating=!1,this.calCount=0,this.id=null,this.scheduleMode="FCFS",this.active_=!0,this.scheduleQueue=[],this.scheduleHeap=new i(a),this.load=0,this.id=e,this.startExec=t,this.endExec=s}}e.exports={Core:n,coreNums:4}},4558:(e,t,s)=>{"use strict";let r=s(3411);class i extends r{async auxTwoPhaseTMR(e,t,s,i){return Promise.all([e,t]).then(async e=>{if("TPTMPnoPass"==r.FT.TPTMR_Primary(...e))try{let[t]=this.executeTask(s),a=await t,n=r.FT.TMR(...e,a);return"function"==typeof i&&i(1,3,n),n}catch(e){}else{let t=e[0];return"function"==typeof i&&i(1,2,t),t}})}async runWithTwoPhaseTMRForRandom(e,t){this.switchScheduleMode(r.mode_FCFS);let s=[],i=e.length;for(let r=0;r<i;r++){let i=e[r],[a]=this.executeTask({...i}),[n]=this.executeTask({...i});s.push(this.auxTwoPhaseTMR(a,n,{...i},t))}return Promise.all(s)}async runWithTwoPhaseTMRForGraph(e,t){return this.switchScheduleMode(r.mode_LTF),this.graphAppShedule(e,e=>{let[s]=this.executeTask({...e}),[r]=this.executeTask({...e});return this.auxTwoPhaseTMR(s,r,{...e},t)})}constructor(e,t,s){super(e,t,s)}}e.exports=i},7260:(e,t,s)=>{"use strict";let r=s(3411);class i extends r{addInSideTasks(e,t,s){this.sideTasks[t].add(e),this.inTurnForSideTasks[t].set(e,s),this.failedCountSideTasks[t].set(e,0)}removeInSideTasks(e,t){return this.sideTasks[e].has(t)?(this.sideTasks[e].delete(t),this.inTurnForSideTasks[e].delete(t),this.failedCountSideTasks[e].delete(t),this.sideTasks[e].size):-1}R_TMR_roundEnd(e){let{flagArr:t,historyArr:s}=this;for(let r=0;r<4;r++){let i=t[r];for(let t=0;t<i.length;t++)0===i[t]&&1===s[r][t]?s[r][t]=0:1!==i[t]||s[r][t]?1===i[t]&&1===s[r][t]&&(s[r][t]=0,i[t]=0,this.deactiveCore(r),this.addInSideTasks(t,r,e)):(s[r][t]=1,i[t]=0)}}auxReactiveTMR(e,t,s){let{callCores:r,callArr:i,noMoreCore:a}=this.runOnDistinctCores(2,this.brokenCores,e);return this.ReactiveTMR(e,{two_FreeCores:r,callArr:i,noMoreCore:a},t).then(r=>(this.tryReactiveCore(e,r,s,t),r))}setAppID(e){let t=this.AppRecord.find(t=>t.pid==e.pid);return void 0===t?(t={pid:e.pid,round:0},this.AppRecord.push(t)):t.round++,t}async runWithReactiveTMRForRandom(e,t){let s=this.setAppID(e);this.switchScheduleMode(r.mode_FCFS);let i=[];for(let r=0;r<e.length;r++){let a=e[r];i.push(this.auxReactiveTMR(a,t,s.round))}let a=await Promise.all(i);return this.R_TMR_roundEnd(s.round),a}async runWithReactiveTMRForGraph(e,t){let s=this.setAppID(e);this.switchScheduleMode(r.mode_LTF);let i=[];i.push(this.graphAppShedule(e,e=>this.auxReactiveTMR(e,t,s.round)));let a=Promise.all(i);return this.R_TMR_roundEnd(s.round),a}async tryReactiveCore(e,t,s,r){let i=this.getSideTaskOnWhichCore(e),a=e.id;if(i.length)for(let n=0;n<i.length;n++){let o=i[n];if(!this.checkIfCompareRound(a,o,s))return;let l=await this.cores[o].calculate({...e});"function"==typeof r&&r(0,1,.5),l===t?0===this.removeInSideTasks(o,a)&&this.activeCore(o):this.increaseCompareRound(o,a)}}getSideTaskOnWhichCore(e){let t=[];for(let s=0;s<4;s++)this.sideTasks[s].has(e.id)&&t.push(s);return t}checkIfCompareRound(e,t,s){if(this.inTurnForSideTasks[t].has(e)){let r=this.inTurnForSideTasks[t].get(e),i=this.failedCountSideTasks[t].get(e);return r+2**i<=s}throw Error("checkIfCompareRound error")}increaseCompareRound(e,t){if(!this.failedCountSideTasks[e].has(t))throw console.error(e,this.failedCountSideTasks),Error("increaseCompareRound error");let s=this.failedCountSideTasks[e].get(t)+1;this.failedCountSideTasks[e].set(t,s)}async runWithOutBrokenCore(e){if(4===this.brokenCores.size)throw Error("no more regular cores to used");return new Promise(t=>{let s=this.getSortedCoresByLoad().filter(e=>!this.brokenCores.has(e.id));t([s[0].calculate({...e}),s[0].id])})}async TwoPhaseTMROnOneCore(e,t){let[s]=await this.runWithOutBrokenCore(e),[i]=await this.runWithOutBrokenCore(e),a=r.FT.TPTMR_Primary(await s,await i);if("TPTMPnoPass"!=a)return"function"==typeof t&&t(1,2,a),[a];{let[a]=await this.runWithOutBrokenCore(e),n=r.FT.TMR(s,i,await a);return"function"==typeof t&&t(1,3,n),[n]}}async ReactiveTMR(e,t,s){let{two_FreeCores:i,callArr:a,noMoreCore:n}=t;if(n){let[t]=await this.TwoPhaseTMROnOneCore(e,s);return t}let o=await Promise.all(a);if("TPTMPnoPass"==r.FT.TPTMR_Primary(...o))if(this.brokenCores.size<2){let t=new Set([...i,...this.brokenCores]),{callCores:a,callArr:n}=this.runOnDistinctCores(1,t,e),l=await n[0],u=[...i,...a],[d,c]=r.FT.TMR_with_fault_core(...o,l,u);if(!Array.isArray(c)){let{flagArr:t}=this;t[c][e.id]=1}return"function"==typeof s&&s(1,3,d),d}else{let t=null,a=null;try{[t,a]=await this.runWithOutBrokenCore(e);let[n,l]=r.FT.TMR_with_fault_core(...o,await t,[i,a]);if(!Array.isArray(l)){let{flagArr:t}=this;t[l][e.id]=1}return"function"==typeof s&&s(1,3,n),n}catch(e){console.error(e,o,t)}}else{let e=o[0];return"function"==typeof s&&s(1,2,e),e}}constructor(e,t,s,r){super(e,t,s),this.sideTasks=[new Set,new Set,new Set,new Set],this.inTurnForSideTasks=[new Map,new Map,new Map,new Map],this.failedCountSideTasks=[new Map,new Map,new Map,new Map],this.AppRecord=[],this.brokenCores=new Set,this.flagArr=[[],[],[],[]],this.historyArr=[[],[],[],[]],this.activeCore=e=>{if(!this.brokenCores.delete(e))throw Error("activeCore error: "+e);this.cores[e].active(),r(e,!1)},this.deactiveCore=e=>{this.brokenCores.add(e),this.cores[e].deactiveCore(),r(e,!0)}}}e.exports=i},7285:(e,t,s)=>{"use strict";let r=s(3411);class i extends r{executeTaskWithTMR(e,t){let{callCores:s,callArr:i}=this.runOnDistinctCores(3,null,e);return Promise.all(i).then(e=>{let s=r.FT.TMR(...e);return"function"==typeof t&&t(1,3,s),s})}async runWithTMRForRandomData(e,t){this.switchScheduleMode(r.mode_FCFS);let s=[],i=e.length;for(let r=0;r<i;r++){let i=e[r];s.push(this.executeTaskWithTMR(i,t))}return await Promise.all(s)}async runWithTMRForGraphData(e,t){return this.switchScheduleMode(r.mode_LTF),this.graphAppShedule(e,e=>this.executeTaskWithTMR(e,t))}constructor(e,t,s){super(e,t,s)}}e.exports=i},8010:(e,t,s)=>{var r={"./fpppp.json":[4816,816],"./robot.json":[8890,890],"./sparse.json":[8764,764]};function i(e){if(!s.o(r,e))return Promise.resolve().then(()=>{var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=r[e],i=t[0];return s.e(t[1]).then(()=>s.t(i,19))}i.keys=()=>Object.keys(r),i.id=8010,e.exports=i},8995:(e,t,s)=>{Promise.resolve().then(s.bind(s,9544))},9188:(e,t,s)=>{"use strict";let{calProbability:r,hitProbability:i}=s(3481),a=0;class n{constructor(e,t){null!=e&&null!=t?(this.id=e,this.duration=t,this.transientFaultProbality=r(this.duration)):(this.id=a++,this.duration=10*Math.random(),this.transientFaultProbality=r(this.duration)+.05)}}e.exports=n},9544:(e,t,s)=>{"use strict";s.d(t,{default:()=>V});var r=s(5155),i=s(9137),a=s.n(i),n=s(2115),o=s(5695);let l=["Idel","Busy","Broke"];var u=s(4719),d=s(7633);function c(){let e=(0,u._)(["\n  width: 50px;\n"]);return c=function(){return e},e}function h(){let e=(0,u._)(["\n  width: 200px;\n  margin: 20px;\n  padding: 10px;\n  border: 1px solid #ddd;\n  border-radius: 10px;\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n  text-align: center;\n  border-color: ",";\n"]);return h=function(){return e},e}function p(){let e=(0,u._)(["\n  display: flex;\n  justify-content: space-around;\n  margin-top: 10px;\n"]);return p=function(){return e},e}function f(){let e=(0,u._)(["\n  display: flex;\n  justify-content: space-around;\n  margin-top: 10px;\n"]);return f=function(){return e},e}function m(){let e=(0,u._)(["\n  position: relative;\n  width: 20px;\n  height: 20px;\n  border-radius: 5%;\n  background-color: ",";\n  ","\n"]);return m=function(){return e},e}function x(){let e=(0,u._)(["\n  position: relative;\n  width: 20px;\n  height: 20px;\n  border-radius: 50%;\n  background-color: ",";\n  ","\n  ","\n"]);return x=function(){return e},e}function T(){let e=(0,u._)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin-top: 50px;\n  position: relative;\n"]);return T=function(){return e},e}function b(){let e=(0,u._)(["\n  display: flex;\n  width: 720px;\n  flex-wrap: wrap;\n  justify-content: start;\n"]);return b=function(){return e},e}let w=d.Ay.div(c()),y=d.Ay.div(h(),e=>e.bordercolor),k=d.Ay.div(p());d.Ay.div(f()),d.Ay.div(m(),e=>{switch(e.state){case"Idle":default:return"#28a745";case"Broke":return"#e74c3c"}},e=>e.disabled&&'&:before {\n    content: "";\n    position: absolute;\n    top: -3px;\n    left: 9px;\n    display: block;\n    width:1px;\n    height: 26px;\n    background: black;\n    transform: rotate(-45deg);\n  }');let g=d.Ay.div(x(),e=>{switch(e.state){case"Idel":default:return"#28a745";case"Busy":return"#ffcc00";case"Broke":return"#e74c3c"}},e=>e.disabled&&'&:before {\n    content: "";\n    position: absolute;\n    top: 0px;\n    left: 9px;\n    display: block;\n    width:1px;\n    height: 19px;\n    background: black;\n    transform: rotate(-45deg);\n  }',e=>e.bordercolor&&"\n    border: 1px solid ".concat(e.bordercolor,"\n    ")),j=d.Ay.div(T());d.Ay.div(b());let C=()=>(0,r.jsx)("div",{className:"w-[800px]",children:(0,r.jsxs)("div",{className:"state ml-5 flex items-center w-[400px] justify-between",children:["Cores:",(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"mr-2 ml-2",children:(0,r.jsx)(g,{state:l[0]})})," Idle",(0,r.jsx)("span",{className:"mr-2 ml-2",children:(0,r.jsx)(g,{state:l[1]})})," Busy",(0,r.jsx)("span",{className:"mr-2 ml-2",children:(0,r.jsx)(g,{state:l[2]})})," Damaged",(0,r.jsx)("span",{className:"mr-2 ml-2",children:(0,r.jsx)(g,{state:l[0],disabled:!0})})," Disabled"]})]})}),R=()=>l[Math.floor(Math.random()*l.length)],v=e=>{let{machineId:t,coreState:s,coresDisabled:i,isLeader:a,leaderCore:n}=e;return(0,r.jsxs)(y,{bordercolor:a?"#87CEEB":"#ddd",children:[(0,r.jsxs)("h3",{children:["Node ",t+1]}),(0,r.jsxs)(k,{children:[(0,r.jsx)(w,{children:"Cores:"}),(0,r.jsx)("div",{style:{display:"flex",justifyContent:"space-between",width:"90px"},children:[void 0,void 0,void 0,void 0].map((e,o)=>(0,r.jsx)(g,{state:s&&s[o]||R(),disabled:i&&i[o],bordercolor:a&&n&&n[t]===o?"#F7DC6F":"transparent"},o))})]})]})},M=e=>{let{children:t}=e;return(0,r.jsx)("div",{className:"mt-2",children:t})},S=e=>{let{experimentStates:t}=e;return(0,r.jsxs)(j,{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mt-5 mb-5",children:"Experiment Result"}),(0,r.jsxs)(M,{children:["Original task: ",t[0]]}),(0,r.jsxs)(M,{children:["Executed task: ",t[1]]}),(0,r.jsxs)(M,{children:["Correct result: ",t[2]]}),(0,r.jsxs)(M,{children:["Faulty result: ",t[3]]}),(0,r.jsxs)(M,{children:["PoF: ",t[4].toFixed(4)]})]})},F=s(7260),P=s(4558),N=s(7285),_=[["Broke","Idel","Idel","Idel"],["Idel","Idel","Idel","Idel"],["Broke","Broke","Broke","Broke"],["Broke","Broke","Broke","Idel"],["Broke","Broke","Idel","Idel"]];function E(e,t){return s=>{t(t=>{let r=[...t],i=[...r[e]];return i[s]="Busy",r[e]=i,r})}}function A(e,t){return(s,r)=>{t(t=>{let i=[...t],a=[...i[e]];return a[s]=r?"Broke":"Idel",i[e]=a,i})}}async function D(e,t,s,r,i,a){let n=[,,,,,].fill(null).map((e,t)=>new N(t,E(t,i),A(t,i)));for(let e=0;e<5;e++)for(let t=0;t<4;t++)"Broke"===_[e][t]&&n[e].brokeCore(t);let o=[],l=0,u=0,d=0,c=[],h=[],p=(e,t,i)=>{l+=e,u+=t,.5!==i&&(d+=1);let n=(d/l).toFixed(4);c.push([l,u,"C-TMR"]),h.push([l,n,"C-TMR"]),s([...c]),r([...h]),a([l,u,l-d,d,n])};for(let s=0;s<50;s++){for(let s=0;s<5;s++){let r=n[s];t?o.push(r.runWithTMRForRandomData(e,p)):o.push(r.runWithTMRForGraphData(e,p))}await Promise.all(o)}return o}async function B(e,t,s,r,i,a){let n=[,,,,,].fill(null).map((e,t)=>new P(t,E(t,i),A(t,i)));for(let e=0;e<5;e++)for(let t=0;t<4;t++)"Broke"===_[e][t]&&n[e].brokeCore(t);let o=[],l=0,u=0,d=0,c=[],h=[],p=(e,t,i)=>{l+=e,u+=t,.5!==i&&(d+=1);let n=(d/l).toFixed(4);c.push([l,u,"TP-TMR"]),s([...c]),h.push([l,n,"TP-TMR"]),r([...h]),a([l,u,l-d,d,n])};for(let s=0;s<50;s++){for(let s=0;s<5;s++){let r=n[s];t?o.push(r.runWithTwoPhaseTMRForRandom(e,p)):o.push(r.runWithTwoPhaseTMRForGraph(e,p))}await Promise.all(o)}}async function O(e,t,s,r,i,a,n){let o=[,,,,,].fill(null).map((e,t)=>new F(t,E(t,i),A(t,i),(e,s)=>{n(r=>{let i=[...r],a=[...i[t]];return a[e]=s,i[t]=a,i})}));for(let e=0;e<5;e++)for(let t=0;t<4;t++)"Broke"===_[e][t]&&o[e].brokeCore(t);let l=[],u=0,d=0,c=0,h=[],p=[],f=(e,t,i)=>{u+=e,d+=t,.5!==i&&(c+=1);let n=(c/u).toFixed(4);h.push([u,d,"R-TMR"]),s([...h]),p.push([u,n,"R-TMR"]),r([...p]),a([u,d,u-c,c,n])};for(let s=0;s<50;s++){for(let s=0;s<5;s++){let r=o[s];t?l.push(r.runWithReactiveTMRForRandom(e,f)):l.push(r.runWithReactiveTMRForGraph(e,f))}await Promise.all(l)}}let I={},z=e=>{let{AppBeTest:t,isRandomData:s,setRTMRexcutedNumsComp:i,setRTMRexcutedPofComp:a}=e,[o,l]=(0,n.useState)(_),[u,d]=(0,n.useState)([,,,,,].fill(null).map(()=>[,,,,].fill(!1))),[c,h]=(0,n.useState)([0,0,0,0,0]);return(0,n.useEffect)(()=>{!function(e){I.setCoreStateForReactiveTMR=e}(l),function(e){I.setExperimentStateForReactiveTMR=e}(h),function(e){I.setCoresDisabledForReactiveTMR=e}(d)},[]),(0,r.jsxs)("div",{className:"flex w-full justify-around",children:[(0,r.jsx)("div",{className:"w-[720px] flex justify-center",children:(0,r.jsxs)(j,{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mt-5 mb-5",children:"Reactive TMR Dashboard"}),(0,r.jsx)("div",{className:"flex w-[720px] flex-wrap justify-start",children:[,,,,,].fill(null).map((e,t)=>(0,r.jsx)(v,{machineId:t,coreState:o[t],coresDisabled:u[t]},t))}),(0,r.jsx)("button",{className:"border border-gray-200 py-2 px-4 rounded",onClick:()=>O(t,s,i,a),children:"Start Experiment"})]})}),(0,r.jsx)(S,{experimentStates:c})]})},W=e=>{let{AppBeTest:t,isRandomData:s,setTMRExcutedNumsComp:i,setTMRExcutedPofComp:a}=e,[o,l]=(0,n.useState)(_),[u,d]=(0,n.useState)([0,0,0,0,0]);return(0,n.useEffect)(()=>{!function(e){I.setCoreStateForTMR=e}(l),function(e){I.setExperimentStateForTMR=e}(d)},[]),(0,r.jsxs)("div",{className:"flex w-full justify-around",children:[(0,r.jsx)("div",{className:"w-[720px] flex justify-center",children:(0,r.jsxs)(j,{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mt-5 mb-5",children:"TMR Dashboard"}),(0,r.jsx)("div",{className:"flex w-[720px] flex-wrap justify-start",children:[,,,,,].fill(null).map((e,t)=>(0,r.jsx)(v,{machineId:t,coreState:o[t]},t))}),(0,r.jsx)("button",{className:"border border-gray-200 py-2 px-4 rounded",onClick:function(){D(t,s,i,a)},children:"Start Experiment"})]})}),(0,r.jsx)(S,{experimentStates:u})]})},L=e=>{let{AppBeTest:t,isRandomData:s,setTPTMRexcutedNumsComp:i,setTPTMRexcutedPofComp:a}=e,[o,l]=(0,n.useState)(_),[u,d]=(0,n.useState)([0,0,0,0,0]);return(0,n.useEffect)(()=>{!function(e){I.setCoreStateForTwoPhaseTMR=e}(l),function(e){I.setExperimentStateForTwoPhaseTMR=e}(d)},[]),(0,r.jsxs)("div",{className:"flex w-full justify-around",children:[(0,r.jsx)("div",{className:"w-[720px] flex justify-center",children:(0,r.jsxs)(j,{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mt-5 mb-5",children:"Two Phase TMR Dashboard"}),(0,r.jsx)("div",{className:"flex w-[720px] flex-wrap justify-start",children:[,,,,,].fill(null).map((e,t)=>(0,r.jsx)(v,{machineId:t,coreState:o[t]},t))}),(0,r.jsx)("button",{className:"border border-gray-200 py-2 px-4 rounded",onClick:()=>B(t,s,i,a),children:"Start Experiment"})]})}),(0,r.jsx)(S,{experimentStates:u})]})};var G=s(9188),U=s.n(G),H=s(2444);let Q=e=>{let{graphData:t,amplife:s}=e,i=(0,n.useRef)(null);return(0,n.useEffect)(()=>{if(!t)return;var e=H.Ts(i.current);let r=t.map(e=>({name:"T".concat(e.id,"\n").concat(e.duration),id:e.id})),a=[];for(let e=0;e<t.length;e++)for(let s of t[e].predecessors)a.push({source:+s,target:e});let n=function(e,t){let s=new Map(e.map(e=>[e.id,0])),r=new Map;for(let{source:e,target:i}of t)s.set(i,s.get(i)+1),r.has(e)||r.set(e,[]),r.get(e).push(i);let i=new Map,a=[];for(let[e,t]of s.entries())0===t&&a.push({id:e,level:0});for(;a.length>0;){let{id:e,level:t}=a.shift();for(let n of(i.set(e,t),r.get(e)||[]))s.set(n,s.get(n)-1),0===s.get(n)&&a.push({id:n,level:t+1})}return i}(r,a),o=function(e,t,s){let r={};for(let s of e){let e=t.get(s.id)||0;r[e]||(r[e]=[]),r[e].push(s.id)}let i=[],a=180+200*!!s;for(let[t,s]of Object.entries(r)){let r=parseInt(t);s.forEach((t,s)=>{i.push({name:e[t].name,x:600*r,y:s*a})})}return i}(r,n,s),l=s?2:1;e.setOption({title:{text:""},tooltip:{},animationDurationUpdate:1500,animationEasingUpdate:"quinticInOut",series:[{type:"graph",layout:"none",symbolSize:15*l,coordinateSystem:null,label:{show:!0,fontSize:6*l},edgeSymbol:["circle","arrow"],edgeSymbolSize:4,edgeLabel:{fontSize:6*l},data:o,links:a,lineStyle:{opacity:.9,width:.5,curveness:0}}]})},[t,s]),(0,r.jsx)("div",{className:"flex items-center w-full align-middle justify-center",children:(0,r.jsx)("div",{id:"main",style:{width:"100%",height:"700px"},ref:i})})},q=["random","robot","fpppp","sparse"],Y=e=>{let{randomTask:t}=e;return(0,r.jsx)("div",{className:"flex px-[10%] flex-wrap",children:Array.isArray(t)&&t.map(e=>(0,r.jsxs)("div",{className:"bg-white border rounded-2xl p-2 hover:scale-[1.02] my-5 ml-5 w-16 transition-transform",children:[(0,r.jsxs)("h3",{className:"text-base font-semibold text-gray-800 mb-1 text-center",children:["T",e.id]}),(0,r.jsx)("p",{className:"text-gray-600 text-sm text-center",children:e.duration.toFixed(2)})]},e.id))})},Z=e=>{let{selected:t,setSelected:i,taskLen:a,setTaskLen:o,graphData:l,setGraphData:u,randomTask:d}=e;return(0,n.useEffect)(()=>{"random"!==t&&s(8010)("./".concat(t,".json")).then(e=>{u(e.default)})},[t]),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"p-6 max-w-md ml-[10%] pl-3",children:[(0,r.jsx)("label",{htmlFor:"data-select",className:"block mb-2 font-medium",children:"Select Data Type:"}),(0,r.jsx)("select",{id:"data-select",value:t,onChange:e=>i(e.target.value),className:"w-full p-2 border rounded",children:q.map(e=>(0,r.jsx)("option",{value:e,children:e},e))}),"random"===t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("label",{htmlFor:"task-len",className:"block mb-2 mt-2 font-medium",children:"TaskLen:"}),(0,r.jsx)("input",{id:"task-len",className:"w-full p-2 border rounded",type:"number",onChange:function(e){let t=e.target.value;if(+t>80)return void window.alert("can't above 80");o(t)},value:a})]})]}),"random"!==t&&(0,r.jsx)(Q,{graphData:l,amplife:"robot"==t}),"random"===t&&(0,r.jsx)(Y,{randomTask:d})]})};function J(e,t,s,r){let i=[],a=[];H.ZS.each(["C-TMR","TP-TMR","R-TMR","FDT-TMR"],function(e){var t="dataset_"+e;i.push({id:t,fromDatasetId:"dataset_raw",transform:{type:"filter",config:{and:[{dimension:r,gte:0},{dimension:"Method","=":e}]}}}),a.push({type:"line",datasetId:t,showSymbol:!1,name:e,endLabel:{show:!0,formatter:function(e){return e.value[2]+": "+e.value[1]}},labelLayout:{moveOverlap:"shiftY"},emphasis:{focus:"series"},encode:{x:"Orginal Tasks Num",y:r,label:[r,"Orginal Tasks Num"],itemName:r,tooltip:[r]}})});let n={animationDuration:1e4,dataset:[{id:"dataset_raw",source:e},...i],title:{text:s},tooltip:{order:"valueDesc",trigger:"axis"},xAxis:{type:"category",nameLocation:"middle",name:"Original Tasks Num",nameGap:30},yAxis:{name:r},grid:{right:140},series:a};t.setOption(n)}let K=e=>{let{taskNumExperimentData:t,taskPofExperimentData:s}=e,i=(0,n.useRef)(null),a=(0,n.useRef)(null);return(0,n.useEffect)(()=>{let e=H.Ts(i.current),r=H.Ts(a.current);J(t,e,"Excuted Task Num Comparison","Excuted Tasks Num"),J(s||[],r,"PoF Comparison","PoF")},[t,s]),(0,r.jsxs)("div",{className:"flex items-center w-full align-middle ",children:[(0,r.jsx)("div",{id:"1",style:{width:"600px",height:"400px"},ref:i}),(0,r.jsx)("div",{id:"2",style:{width:"600px",height:"400px"},ref:a})]})},V=()=>{let e=(0,o.useSearchParams)().get("modal"),t=(0,o.useRouter)(),[s,i]=(0,n.useState)(!1),[l,u]=(0,n.useState)("random"),[d,c]=(0,n.useState)("10"),[h,p]=(0,n.useState)(void 0),f="random"===l,m=(0,n.useMemo)(()=>f?Array(+d).fill(null).map((e,t)=>{let s=new(U());return s.id=t,s}):[],[d,f]),[x,T]=(0,n.useState)([]),[b,w]=(0,n.useState)([]),[y,k]=(0,n.useState)([]),[g,j]=(0,n.useState)([]),[R,v]=(0,n.useState)([]),[M,S]=(0,n.useState)([]),[F,P]=(0,n.useState)([]),[N,_]=(0,n.useState)([]),E=(0,n.useMemo)(()=>{let e=x.concat(b,y,g).sort((e,t)=>e[0]-t[0]);return g.length>1e3&&console.log(g[g.length-1]),console.warn=()=>null,e.unshift(["Orginal Tasks Num","Excuted Tasks Num","Method"]),e},[x,b,y,g]),A=(0,n.useMemo)(()=>{let e=R.concat(M,F,N).sort((e,t)=>e[0]-t[0]);return e.unshift(["Orginal Tasks Num","PoF","Method"]),e},[R,M,F,N]),D=f?m:h;return(0,n.useEffect)(()=>{"alg"===e?document.body.style.overflow="hidden":document.body.style.overflow="scroll",i("alg"===e)},[e]),(0,r.jsxs)("div",{className:"jsx-b405a942a315b0a0",children:[s&&(0,r.jsx)("div",{onClick:function(){t.replace("/")},className:"jsx-b405a942a315b0a0 modal",children:(0,r.jsxs)("div",{onClick:function(e){e.stopPropagation()},className:"jsx-b405a942a315b0a0 modal-content",children:[(0,r.jsx)(Z,{selected:l,setSelected:u,taskLen:d,setTaskLen:c,graphData:h,setGraphData:p,randomTask:m}),(0,r.jsx)("div",{className:"jsx-b405a942a315b0a0 pl-[10%] pt-20",children:(0,r.jsx)(C,{})}),(0,r.jsx)(W,{AppBeTest:D,isRandomData:f,setTMRExcutedNumsComp:T,setTMRExcutedPofComp:v}),(0,r.jsx)("div",{className:"jsx-b405a942a315b0a0 border-t-2 border-gray-200 mt-10"}),(0,r.jsx)(L,{AppBeTest:D,isRandomData:f,setTPTMRexcutedNumsComp:w,setTPTMRexcutedPofComp:S}),(0,r.jsx)("div",{className:"jsx-b405a942a315b0a0 border-t-2 border-gray-200 mt-10"}),(0,r.jsx)(z,{AppBeTest:D,isRandomData:f,setRTMRexcutedNumsComp:k,setRTMRexcutedPofComp:P}),(0,r.jsx)("div",{className:"jsx-b405a942a315b0a0 border-t-2 border-gray-200 mt-10"}),(0,r.jsx)(K,{taskNumExperimentData:E,taskPofExperimentData:A})]})}),(0,r.jsx)(a(),{id:"b405a942a315b0a0",children:".modal.jsx-b405a942a315b0a0{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.modal-content.jsx-b405a942a315b0a0{background:white;height:40rem;padding:2rem;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;overflow:scroll}"})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[693,441,684,358],()=>t(8995)),_N_E=e.O()}]);