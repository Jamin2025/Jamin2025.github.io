(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3411:(e,t,r)=>{"use strict";let{coreNums:s,Core:i}=r(4477);class n{brokeCore(e){this.cores[e].broke()}async runOnDistinctFreeCores(e,t,r){let i=0,n=t instanceof Set;if(n&&4===t.size)throw Error("runOnDistinctFreeCores error");return n&&s-t.size<e?Promise.reject("no more distinct core"):await new Promise(async(s,a)=>{let o=[],l=[],c=[];for(let a=0;a<4;a++)n&&t.has(a)||c.push(this.cores[a].curCalculate.then(()=>(i<e&&(++i,l.push(this.cores[a].calculate(r)),o.push(a),i===e&&s({freeCores:o,callArr:l})),null)));Promise.all(c).then(()=>{i<e&&a("no more distinct core")})})}async executeTask(e){return new Promise(t=>{let r=!1;for(let s=0;s<4;s++)this.cores[s].curCalculate.then(()=>{if(r)return null;r=!0,t([this.cores[s].calculate(e),s])})})}getTaskRunCount(){return this.cores.reduce((e,t)=>e+t.calCount,0)}constructor(e,t){this.cores=Array(s),this.NodeID=null;let{cores:r}=this;this.NodeID=t;for(let t=0;t<s;t++)r[t]=new i(t,e,this.NodeID)}}n.FT={TMR_with_fault_core:(e,t,r,s)=>e==t?[e,s[2]]:e==r?[r,s[1]]:t==r?[t,s[0]]:[0,s],TMR:(e,t,r)=>e==t?e:e==r?r:t==r?t:0,TPTMR_Primary:(e,t)=>e==t?e:"TPTMPnoPass"},e.exports=n},3481:e=>{"use strict";let t=e=>{let t=1;for(let r=2;r<=e;r++)t*=r;return t};e.exports={hitProbability:function(e){return Math.random()<e},calProbability:function(e){return 1-function(e,r){let s=Math.E;return s**-e*1/t(0)}(.001*e,0)}}},4086:(e,t,r)=>{"use strict";r.r(t),r.d(t,{activeCoresForReactiveTMR:()=>C,coreRestoreForReactiveTMR:()=>b,coreRestoreForTMR:()=>o,coreRestoreForTwoPhaseTMR:()=>f,coreToBusyForReactiveTMR:()=>T,coreToBusyForTMR:()=>a,coreToBusyForTwoPhaseTMR:()=>h,deactiveCoresForReactiveTMR:()=>k,insetCoreStateForReactiveTMR:()=>x,insetCoreStateForTMR:()=>n,insetCoreStateForTwoPhaseTMR:()=>d,insetCoresDisabledForReactiveTMR:()=>v,insetExperimentStateForReactiveTMR:()=>w,insetExperimentStateForTMR:()=>c,insetExperimentStateForTwoPhaseTMR:()=>m,insetStorageStateForReactiveTMR:()=>R,insetStorageStateForTMR:()=>l,setExperimentStateForReactiveTMR:()=>y,setExperimentStateForTMR:()=>u,setExperimentStateForTwoPhaseTMR:()=>p});let s={};function i(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];e in s&&s[e](...r)}function n(e){s.setCoreStateForTMR=e}function a(e,t){i("setCoreStateForTMR",r=>{let s=[...r],i=[...s[t]];return i[e]="Busy",s[t]=i,s})}function o(e,t,r){i("setCoreStateForTMR",s=>{let i=[...s],n=[...i[r]];return n[e]=t?"Broke":"Idel",i[r]=n,i})}function l(e){s.setStorageStateForTMR=e}function c(e){s.setExperimentStateForTMR=e}function u(e){i("setExperimentStateForTMR",e)}function d(e){s.setCoreStateForTwoPhaseTMR=e}function h(e,t){i("setCoreStateForTwoPhaseTMR",r=>{let s=[...r],i=[...s[t]];return i[e]="Busy",s[t]=i,s})}function f(e,t,r){i("setCoreStateForTwoPhaseTMR",s=>{let i=[...s],n=[...i[r]];return n[e]=t?"Broke":"Idel",i[r]=n,i})}function m(e){s.setExperimentStateForTwoPhaseTMR=e}function p(e){i("setExperimentStateForTwoPhaseTMR",e)}function x(e){s.setCoreStateForReactiveTMR=e}function T(e,t){i("setCoreStateForReactiveTMR",r=>{let s=[...r],i=[...s[t]];return i[e]="Busy",s[t]=i,s})}function b(e,t,r){i("setCoreStateForReactiveTMR",s=>{let i=[...s],n=[...i[r]];return n[e]=t?"Broke":"Idel",i[r]=n,i})}function R(e){s.setStorageStateForReactiveTMR=e}function w(e){s.setExperimentStateForReactiveTMR=e}function y(e){i("setExperimentStateForReactiveTMR",e)}function v(e){s.setCoresDisabledForReactiveTMR=e}function k(e,t){i("setCoresDisabledForReactiveTMR",r=>{let s=[...r];return s[t][e]=!0,s})}function C(e,t){i("setCoresDisabledForReactiveTMR",r=>{let s=[...r];return s[t][e]=!1,s})}},4477:(e,t,r)=>{"use strict";let{hitProbability:s}=r(3481),{coreToBusyForTMR:i,coreRestoreForTMR:n,coreToBusyForTwoPhaseTMR:a,coreRestoreForTwoPhaseTMR:o,coreRestoreForReactiveTMR:l,coreToBusyForReactiveTMR:c,coreToBusyForClusterTMR:u,coreRestoreForClusterTMR:d}=r(4086);class h{deactiveCore(){this.active_=!1}active(){this.active_=!0}calculate(e){if(this.calCount++,this.isCalculate)return this.curCalculate.then(()=>this.calculate(e));this.isCalculate=!0;let t=0===this.mode,r=1===this.mode,h=2===this.mode,f=3===this.mode;return t?i(this.id,this.NodeID):r?a(this.id,this.NodeID):h?(c(this.id,this.NodeID),this.active_||console.info("try reactive")):f&&u(this.id,this.NodeID),this.curCalculate=new Promise(i=>{setTimeout(()=>{this.isNormalOperate()&&!s(e.transientFaultProbality)?e.result=.5:e.result=Math.random(),this.isCalculate=!1,t?n(this.id,this.isPermentFault,this.NodeID):r?o(this.id,this.isPermentFault,this.NodeID):h?l(this.id,this.isPermentFault,this.NodeID):f&&d(this.id,this.isPermentFault,this.NodeID),i(e.result)},1e3*e.duration)}),this.curCalculate}isCalculating(){return this.isCalculate}isNormalOperate(){return!this.isPermentFault}broke(){this.isPermentFault=!0}constructor(e,t,r){this.isPermentFault=!1,this.isCalculate=!1,this.calCount=0,this.NodeID=null,this.id=null,this.mode=null,this.active_=!0,this.curCalculate=Promise.resolve(),this.id=e,this.mode=t,this.NodeID=r}}e.exports={Core:h,coreNums:4}},4558:(e,t,r)=>{"use strict";let s=r(3411),{setExperimentStateForTwoPhaseTMR:i}=r(4086);class n extends s{async runWithTwoPhaseTMR(e,t){let r=[],n=e.length;for(let a=0;a<n;a++){let n=e[a],[o]=await this.executeTask(n),[l]=await this.executeTask(n),c=Promise.all([o,l]).then(async e=>{if("TPTMPnoPass"==s.FT.TPTMR_Primary(...e))try{let[r]=await this.executeTask(n),a=await r,o=s.FT.TMR(...e,a);return i(e=>{let t=[...e];return t[0]+=1,t[1]+=3,.5!==o?t[3]+=1:t[2]+=1,t[4]=t[3]/t[0],t}),"function"==typeof t&&t(1,3,o),o}catch(e){}else{let r=e[0];return i(e=>{let t=[...e];return t[0]+=1,t[1]+=2,.5!==r?t[3]+=1:t[2]+=1,t[4]=t[3]/t[0],t}),"function"==typeof t&&t(1,2,r),r}});r.push(c)}return Promise.all(r)}constructor(e){super(1,e)}}e.exports=n},7260:(e,t,r)=>{"use strict";let s=r(3411),{coreNums:i}=r(4477),{setExperimentStateForReactiveTMR:n,deactiveCoresForReactiveTMR:a,activeCoresForReactiveTMR:o}=r(4086);class l extends s{activeCore(e){if(!this.brokenCores.delete(e))throw Error("activeCore error: "+e);o(e,this.NodeID),this.cores[e].active()}addInSideTasks(e,t,r){this.sideTasks[t].add(e),this.inTurnForSideTasks[t].set(e,r),this.failedCountSideTasks[t].set(e,0)}removeInSideTasks(e,t){return this.sideTasks[e].has(t)?(this.sideTasks[e].delete(t),this.inTurnForSideTasks[e].delete(t),this.failedCountSideTasks[e].delete(t),this.sideTasks[e].size):-1}deactiveCore(e){this.brokenCores.add(e),a(e,this.NodeID),this.cores[e].deactiveCore()}R_TMR_roundEnd(e){let{flagArr:t,historyArr:r}=this;for(let s=0;s<4;s++){let i=t[s];for(let t=0;t<i.length;t++)0===i[t]&&1===r[s][t]?r[s][t]=0:1!==i[t]||r[s][t]?1===i[t]&&1===r[s][t]&&(r[s][t]=0,i[t]=0,this.deactiveCore(s),this.addInSideTasks(t,s,e)):(r[s][t]=1,i[t]=0)}}async runWithReactiveTMR(e,t){let r=this.AppRecord.find(t=>t.pid==e.pid);void 0===r?(r={pid:e.pid,round:0},this.AppRecord.push(r)):r.round++;let s=[];for(let i=0;i<e.length;i++){let n=e[i],{freeCores:a,callArr:o,noMoreCore:l}=await this.runOnDistinctFreeCores(2,this.brokenCores,n).catch(e=>{if("no more distinct core"==e)return{freeCores:[],callArr:[],noMoreCore:!0};throw Error(e)}),c=this.ReactiveTMR(n,{two_FreeCores:a,callArr:o,noMoreCore:l},t).then(e=>(this.tryReactiveCore(n,e,r.round,t),e));s.push(c)}let i=await Promise.all(s);return this.R_TMR_roundEnd(r.round),i}async tryReactiveCore(e,t,r,s){let i=this.getSideTaskOnWhichCore(e),a=e.id;if(i.length)for(let o=0;o<i.length;o++){let l=i[o];if(!this.checkIfCompareRound(a,l,r))return;let c=await this.cores[l].curCalculate.then(()=>this.cores[l].calculate(e));n(e=>{let t=[...e];return t[1]+=1,t}),"function"==typeof s&&s(0,1,.5),c===t?0===this.removeInSideTasks(l,a)&&this.activeCore(l):this.increaseCompareRound(l,a)}}getSideTaskOnWhichCore(e){let t=[];for(let r=0;r<4;r++)this.sideTasks[r].has(e.id)&&t.push(r);return t}checkIfCompareRound(e,t,r){if(this.inTurnForSideTasks[t].has(e)){let s=this.inTurnForSideTasks[t].get(e),i=this.failedCountSideTasks[t].get(e);return s+2**i<=r}throw Error("checkIfCompareRound error")}increaseCompareRound(e,t){if(!this.failedCountSideTasks[e].has(t))throw console.error(e,this.failedCountSideTasks),Error("increaseCompareRound error");let r=this.failedCountSideTasks[e].get(t)+1;this.failedCountSideTasks[e].set(t,r)}async runWithOutBrokenCore(e){if(this.brokenCores.size===i)throw Error("no more regular cores to used");return new Promise(t=>{let r=!1;for(let s=0;s<4;s++)this.brokenCores.has(s)||this.cores[s].curCalculate.then(()=>{if(r)return null;r=!0,t([this.cores[s].calculate(e),s])})})}async TwoPhaseTMROnOneCore(e,t){let[r]=await this.runWithOutBrokenCore(e),[i]=await this.runWithOutBrokenCore(e),a=s.FT.TPTMR_Primary(await r,await i);if("TPTMPnoPass"!=a)return n(e=>{let t=[...e];return t[0]+=1,t[1]+=2,.5!==a?t[3]+=1:t[2]+=1,t[4]=t[3]/t[0],t}),"function"==typeof t&&t(1,2,a),[a];{let[a]=await this.runWithOutBrokenCore(e),o=s.FT.TMR(r,i,await a);return n(e=>{let t=[...e];return t[0]+=1,t[1]+=3,.5!==o?t[3]+=1:t[2]+=1,t[4]=t[3]/t[0],t}),"function"==typeof t&&t(1,3,o),[o]}}async ReactiveTMR(e,t,r){let{two_FreeCores:i,callArr:a,noMoreCore:o}=t;if(o){let[t]=await this.TwoPhaseTMROnOneCore(e,r);return t}let l=await Promise.all(a);if("TPTMPnoPass"==s.FT.TPTMR_Primary(...l)){if(this.brokenCores.size<2){let t=new Set([...i,...this.brokenCores]),{freeCores:a,callArr:o}=await this.runOnDistinctFreeCores(1,t,e),c=await o[0],u=[...i,...a],[d,h]=s.FT.TMR_with_fault_core(...l,c,u);if(!Array.isArray(h)){let{flagArr:t}=this;t[h][e.id]=1}return n(e=>{let t=[...e];return t[0]+=1,t[1]+=3,.5!==d?t[3]+=1:t[2]+=1,t[4]=t[3]/t[0],t}),"function"==typeof r&&r(1,3,d),d}{let t=null,a=null;try{[t,a]=await this.runWithOutBrokenCore(e);let[o,c]=s.FT.TMR_with_fault_core(...l,await t,[i,a]);if(!Array.isArray(c)){let{flagArr:t}=this;t[c][e.id]=1}return n(e=>{let t=[...e];return t[0]+=1,t[1]+=3,.5!==o?t[3]+=1:t[2]+=1,t[4]=t[3]/t[0],t}),"function"==typeof r&&r(1,3,o),o}catch(e){console.error(e,l,t)}}}else{let e=l[0];return n(t=>{let r=[...t];return r[0]+=1,r[1]+=2,.5!==e?r[3]+=1:r[2]+=1,r[4]=r[3]/r[0],r}),"function"==typeof r&&r(1,2,e),e}}constructor(e){super(2,e),this.sideTasks=[new Set,new Set,new Set,new Set],this.inTurnForSideTasks=[new Map,new Map,new Map,new Map],this.failedCountSideTasks=[new Map,new Map,new Map,new Map],this.AppRecord=[],this.brokenCores=new Set,this.flagArr=[[],[],[],[]],this.historyArr=[[],[],[],[]]}}e.exports=l},7285:(e,t,r)=>{"use strict";let s=r(3411),{setExperimentStateForTMR:i}=r(4086);class n extends s{async runWithTMR(e,t){let r=[],n=e.length;for(let a=0;a<n;a++){let n=e[a],{callArr:o}=await this.runOnDistinctFreeCores(3,null,n);r.push(Promise.all(o).then(e=>{let r=s.FT.TMR(...e);return i(e=>{let t=[...e];return t[0]+=1,t[1]+=3,.5!==r?t[3]+=1:t[2]+=1,t[4]=t[3]/t[0],t}),"function"==typeof t&&t(1,3,r),r}))}return await Promise.all(r)}constructor(e){super(0,e)}}e.exports=n},8010:(e,t,r)=>{var s={"./fpppp.json":[4816,816],"./robot.json":[8890,890],"./sparse.json":[8764,764]};function i(e){if(!r.o(s,e))return Promise.resolve().then(()=>{var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=s[e],i=t[0];return r.e(t[1]).then(()=>r.t(i,19))}i.keys=()=>Object.keys(s),i.id=8010,e.exports=i},8144:(e,t,r)=>{"use strict";r.d(t,{default:()=>K});var s=r(5155),i=r(9137),n=r.n(i),a=r(2115),o=r(5695);let l=["Idel","Busy","Broke"];var c=r(4719),u=r(7633);function d(){let e=(0,c._)(["\n  width: 50px;\n"]);return d=function(){return e},e}function h(){let e=(0,c._)(["\n  width: 200px;\n  margin: 20px;\n  padding: 10px;\n  border: 1px solid #ddd;\n  border-radius: 10px;\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n  text-align: center;\n  border-color: ",";\n"]);return h=function(){return e},e}function f(){let e=(0,c._)(["\n  display: flex;\n  justify-content: space-around;\n  margin-top: 10px;\n"]);return f=function(){return e},e}function m(){let e=(0,c._)(["\n  display: flex;\n  justify-content: space-around;\n  margin-top: 10px;\n"]);return m=function(){return e},e}function p(){let e=(0,c._)(["\n  position: relative;\n  width: 20px;\n  height: 20px;\n  border-radius: 5%;\n  background-color: ",";\n  ","\n"]);return p=function(){return e},e}function x(){let e=(0,c._)(["\n  position: relative;\n  width: 20px;\n  height: 20px;\n  border-radius: 50%;\n  background-color: ",";\n  ","\n  ","\n"]);return x=function(){return e},e}function T(){let e=(0,c._)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin-top: 50px;\n  position: relative;\n"]);return T=function(){return e},e}function b(){let e=(0,c._)(["\n  display: flex;\n  width: 720px;\n  flex-wrap: wrap;\n  justify-content: start;\n"]);return b=function(){return e},e}let R=u.Ay.div(d()),w=u.Ay.div(h(),e=>e.bordercolor),y=u.Ay.div(f());u.Ay.div(m()),u.Ay.div(p(),e=>{switch(e.state){case"Idle":default:return"#28a745";case"Broke":return"#e74c3c"}},e=>e.disabled&&'&:before {\n    content: "";\n    position: absolute;\n    top: -3px;\n    left: 9px;\n    display: block;\n    width:1px;\n    height: 26px;\n    background: black;\n    transform: rotate(-45deg);\n  }');let v=u.Ay.div(x(),e=>{switch(e.state){case"Idel":default:return"#28a745";case"Busy":return"#ffcc00";case"Broke":return"#e74c3c"}},e=>e.disabled&&'&:before {\n    content: "";\n    position: absolute;\n    top: 0px;\n    left: 9px;\n    display: block;\n    width:1px;\n    height: 19px;\n    background: black;\n    transform: rotate(-45deg);\n  }',e=>e.bordercolor&&"\n    border: 1px solid ".concat(e.bordercolor,"\n    ")),k=u.Ay.div(T());u.Ay.div(b());let C=()=>(0,s.jsx)("div",{className:"w-[800px]",children:(0,s.jsxs)("div",{className:"state ml-5 flex items-center w-[400px] justify-between",children:["Cores:",(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("span",{className:"mr-2 ml-2",children:(0,s.jsx)(v,{state:l[0]})})," Idle",(0,s.jsx)("span",{className:"mr-2 ml-2",children:(0,s.jsx)(v,{state:l[1]})})," Busy",(0,s.jsx)("span",{className:"mr-2 ml-2",children:(0,s.jsx)(v,{state:l[2]})})," Damaged",(0,s.jsx)("span",{className:"mr-2 ml-2",children:(0,s.jsx)(v,{state:l[0],disabled:!0})})," Disabled"]})]})}),M=()=>l[Math.floor(Math.random()*l.length)],j=e=>{let{machineId:t,coreState:r,coresDisabled:i,isLeader:n,leaderCore:a}=e;return(0,s.jsxs)(w,{bordercolor:n?"#87CEEB":"#ddd",children:[(0,s.jsxs)("h3",{children:["Node ",t+1]}),(0,s.jsxs)(y,{children:[(0,s.jsx)(R,{children:"Cores:"}),(0,s.jsx)("div",{style:{display:"flex",justifyContent:"space-between",width:"90px"},children:[void 0,void 0,void 0,void 0].map((e,o)=>(0,s.jsx)(v,{state:r&&r[o]||M(),disabled:i&&i[o],bordercolor:n&&a&&a[t]===o?"#F7DC6F":"transparent"},o))})]})]})},g=e=>{let{children:t}=e;return(0,s.jsx)("div",{className:"mt-2",children:t})},S=e=>{let{experimentStates:t}=e;return(0,s.jsxs)(k,{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mt-5 mb-5",children:"Experiment Result"}),(0,s.jsxs)(g,{children:["Original task: ",t[0]]}),(0,s.jsxs)(g,{children:["Executed task: ",t[1]]}),(0,s.jsxs)(g,{children:["Correct result: ",t[2]]}),(0,s.jsxs)(g,{children:["Faulty result: ",t[3]]}),(0,s.jsxs)(g,{children:["PoF: ",t[4].toFixed(4)]})]})},F=r(7260),P=r(4558),N=r(7285),E=[["Broke","Idel","Idel","Idel"],["Idel","Idel","Idel","Idel"],["Broke","Broke","Broke","Broke"],["Broke","Broke","Broke","Idel"],["Broke","Broke","Idel","Idel"]];async function D(e,t,r,s){let i=[,,,,,].fill(null).map((e,t)=>new F(t));for(let e=0;e<5;e++)for(let t=0;t<4;t++)"Broke"===E[e][t]&&i[e].brokeCore(t);let n=[],a=0,o=0,l=0,c=[],u=[];if(t)for(let t=0;t<100;t++){for(let t=0;t<5;t++){let d=i[t];n.push(d.runWithReactiveTMR(e,(e,t,i)=>{a+=e,o+=t,.5!==i&&(l+=1);let n=(l/a).toFixed(4);c.push([a,o,"R-TMR"]),0!==e&&(u.push([a,n,"R-TMR"]),s([...u])),r([...c])}))}await Promise.all(n)}}async function I(e,t,r,s){let i=[,,,,,].fill(null).map((e,t)=>new P(t));for(let e=0;e<5;e++)for(let t=0;t<4;t++)"Broke"===E[e][t]&&i[e].brokeCore(t);let n=[],a=0,o=0,l=0,c=[],u=[];if(t)for(let t=0;t<100;t++){for(let t=0;t<5;t++){let d=i[t];n.push(d.runWithTwoPhaseTMR(e,(e,t,i)=>{a+=e,o+=t,.5!==i&&(l+=1);let n=(l/a).toFixed(4);c.push([a,o,"TP-TMR"]),u.push([a,n,"TP-TMR"]),r([...c]),s([...u])}))}await Promise.all(n)}}async function _(e,t,r,s){let i=[,,,,,].fill(null).map((e,t)=>new N(t));for(let e=0;e<5;e++)for(let t=0;t<4;t++)"Broke"===E[e][t]&&i[e].brokeCore(t);let n=[],a=0,o=0,l=0,c=[],u=[];if(t)for(let t=0;t<100;t++){for(let t=0;t<5;t++){let d=i[t];n.push(d.runWithTMR(e,(e,t,i)=>{a+=e,o+=t,.5!==i&&(l+=1);let n=(l/a).toFixed(4);c.push([a,o,"C-TMR"]),u.push([a,n,"C-TMR"]),r([...c]),s([...u])}))}await Promise.all(n)}}var B=r(4086);let O=e=>{let{AppBeTest:t,isRandomData:r,setRTMRexcutedNumsComp:i,setRTMRexcutedPofComp:n}=e,[o,l]=(0,a.useState)(E),[c,u]=(0,a.useState)([,,,,,].fill(null).map(()=>[,,,,].fill(!1))),[d,h]=(0,a.useState)([0,0,0,0,0]);return(0,a.useEffect)(()=>{(0,B.insetCoreStateForReactiveTMR)(l),(0,B.insetExperimentStateForReactiveTMR)(h),(0,B.insetCoresDisabledForReactiveTMR)(u)},[]),(0,s.jsxs)("div",{className:"flex w-full justify-around",children:[(0,s.jsx)("div",{className:"w-[720px] flex justify-center",children:(0,s.jsxs)(k,{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mt-5 mb-5",children:"Reactive TMR Dashboard"}),(0,s.jsx)("div",{className:"flex w-[720px] flex-wrap justify-start",children:[,,,,,].fill(null).map((e,t)=>(0,s.jsx)(j,{machineId:t,coreState:o[t],coresDisabled:c[t]},t))}),(0,s.jsx)("button",{className:"border border-gray-200 py-2 px-4 rounded",onClick:()=>D(t,r,i,n),children:"Start Experiment"})]})}),(0,s.jsx)(S,{experimentStates:d})]})},A=e=>{let{AppBeTest:t,isRandomData:r,setTMRExcutedNumsComp:i,setTMRExcutedPofComp:n}=e,[o,l]=(0,a.useState)(E),[c,u]=(0,a.useState)([0,0,0,0,0]);return(0,a.useEffect)(()=>{(0,B.insetCoreStateForTMR)(l),(0,B.insetExperimentStateForTMR)(u)},[]),(0,s.jsxs)("div",{className:"flex w-full justify-around",children:[(0,s.jsx)("div",{className:"w-[720px] flex justify-center",children:(0,s.jsxs)(k,{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mt-5 mb-5",children:"TMR Dashboard"}),(0,s.jsx)("div",{className:"flex w-[720px] flex-wrap justify-start",children:[,,,,,].fill(null).map((e,t)=>(0,s.jsx)(j,{machineId:t,coreState:o[t]},t))}),(0,s.jsx)("button",{className:"border border-gray-200 py-2 px-4 rounded",onClick:function(){_(t,r,i,n)},children:"Start Experiment"})]})}),(0,s.jsx)(S,{experimentStates:c})]})},z=e=>{let{AppBeTest:t,isRandomData:r,setTPTMRexcutedNumsComp:i,setTPTMRexcutedPofComp:n}=e,[o,l]=(0,a.useState)(E),[c,u]=(0,a.useState)([0,0,0,0,0]);return(0,a.useEffect)(()=>{(0,B.insetCoreStateForTwoPhaseTMR)(l),(0,B.insetExperimentStateForTwoPhaseTMR)(u)},[]),(0,s.jsxs)("div",{className:"flex w-full justify-around",children:[(0,s.jsx)("div",{className:"w-[720px] flex justify-center",children:(0,s.jsxs)(k,{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mt-5 mb-5",children:"Two Phase TMR Dashboard"}),(0,s.jsx)("div",{className:"flex w-[720px] flex-wrap justify-start",children:[,,,,,].fill(null).map((e,t)=>(0,s.jsx)(j,{machineId:t,coreState:o[t]},t))}),(0,s.jsx)("button",{className:"border border-gray-200 py-2 px-4 rounded",onClick:()=>I(t,r,i,n),children:"Start Experiment"})]})}),(0,s.jsx)(S,{experimentStates:c})]})};var W=r(9188),L=r.n(W),U=r(2444);let G=e=>{let{graphData:t,amplife:r}=e,i=(0,a.useRef)(null);return(0,a.useEffect)(()=>{if(!t)return;var e=U.Ts(i.current);let s=t.map(e=>({name:"T".concat(e.id,"\n").concat(e.duration),id:e.id})),n=[];for(let e=0;e<t.length;e++)for(let r of t[e].predecessors)n.push({source:+r,target:e});let a=function(e,t){let r=new Map(e.map(e=>[e.id,0])),s=new Map;for(let{source:e,target:i}of t)r.set(i,r.get(i)+1),s.has(e)||s.set(e,[]),s.get(e).push(i);let i=new Map,n=[];for(let[e,t]of r.entries())0===t&&n.push({id:e,level:0});for(;n.length>0;){let{id:e,level:t}=n.shift();for(let a of(i.set(e,t),s.get(e)||[]))r.set(a,r.get(a)-1),0===r.get(a)&&n.push({id:a,level:t+1})}return i}(s,n),o=function(e,t,r){let s={};for(let r of e){let e=t.get(r.id)||0;s[e]||(s[e]=[]),s[e].push(r.id)}let i=[],n=180+200*!!r;for(let[t,r]of Object.entries(s)){let s=parseInt(t);r.forEach((t,r)=>{i.push({name:e[t].name,x:600*s,y:r*n})})}return i}(s,a,r),l=r?2:1;e.setOption({title:{text:""},tooltip:{},animationDurationUpdate:1500,animationEasingUpdate:"quinticInOut",series:[{type:"graph",layout:"none",symbolSize:15*l,coordinateSystem:null,label:{show:!0,fontSize:6*l},edgeSymbol:["circle","arrow"],edgeSymbolSize:4,edgeLabel:{fontSize:6*l},data:o,links:n,lineStyle:{opacity:.9,width:.5,curveness:0}}]})},[t,r]),(0,s.jsx)("div",{className:"flex items-center w-full align-middle justify-center",children:(0,s.jsx)("div",{id:"main",style:{width:"100%",height:"700px"},ref:i})})},q=["random","robot","fpppp","sparse"],Y=e=>{let{randomTask:t}=e;return(0,s.jsx)("div",{className:"flex px-[10%] flex-wrap",children:Array.isArray(t)&&t.map(e=>(0,s.jsxs)("div",{className:"bg-white border rounded-2xl p-2 hover:scale-[1.02] my-5 ml-5 w-16 transition-transform",children:[(0,s.jsxs)("h3",{className:"text-base font-semibold text-gray-800 mb-1 text-center",children:["T",e.id]}),(0,s.jsx)("p",{className:"text-gray-600 text-sm text-center",children:e.duration.toFixed(2)})]},e.id))})},Z=e=>{let{selected:t,setSelected:i,taskLen:n,setTaskLen:o,graphData:l,setGraphData:c,randomTask:u}=e;return(0,a.useEffect)(()=>{"random"!==t&&r(8010)("./".concat(t,".json")).then(e=>{c(e.default)})},[t]),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"p-6 max-w-md ml-[10%] pl-3",children:[(0,s.jsx)("label",{htmlFor:"data-select",className:"block mb-2 font-medium",children:"Select Data Type:"}),(0,s.jsx)("select",{id:"data-select",value:t,onChange:e=>i(e.target.value),className:"w-full p-2 border rounded",children:q.map(e=>(0,s.jsx)("option",{value:e,children:e},e))}),"random"===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("label",{htmlFor:"task-len",className:"block mb-2 mt-2 font-medium",children:"TaskLen:"}),(0,s.jsx)("input",{id:"task-len",className:"w-full p-2 border rounded",type:"number",onChange:function(e){let t=e.target.value;if(+t>80){window.alert("can't above 80");return}o(t)},value:n})]})]}),"random"!==t&&(0,s.jsx)(G,{graphData:l,amplife:"robot"==t}),"random"===t&&(0,s.jsx)(Y,{randomTask:u})]})};function H(e,t,r,s){let i=[],n=[];U.ZS.each(["C-TMR","TP-TMR","R-TMR","FDT-TMR"],function(e){var t="dataset_"+e;i.push({id:t,fromDatasetId:"dataset_raw",transform:{type:"filter",config:{and:[{dimension:s,gte:0},{dimension:"Method","=":e}]}}}),n.push({type:"line",datasetId:t,showSymbol:!1,name:e,endLabel:{show:!0,formatter:function(e){return e.value[2]+": "+e.value[1]}},labelLayout:{moveOverlap:"shiftY"},emphasis:{focus:"series"},encode:{x:"Orginal Tasks Num",y:s,label:[s,"Orginal Tasks Num"],itemName:s,tooltip:[s]}})});let a={animationDuration:1e4,dataset:[{id:"dataset_raw",source:e},...i],title:{text:r},tooltip:{order:"valueDesc",trigger:"axis"},xAxis:{type:"category",nameLocation:"middle",name:"Original Tasks Num",nameGap:30},yAxis:{name:s},grid:{right:140},series:n};t.setOption(a)}let J=e=>{let{taskNumExperimentData:t,taskPofExperimentData:r}=e,i=(0,a.useRef)(null),n=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let e=U.Ts(i.current),s=U.Ts(n.current);H(t,e,"Excuted Task Num Comparison","Excuted Tasks Num"),H(r||[],s,"PoF Comparison","PoF")},[t,r]),(0,s.jsxs)("div",{className:"flex items-center w-full align-middle ",children:[(0,s.jsx)("div",{id:"1",style:{width:"600px",height:"400px"},ref:i}),(0,s.jsx)("div",{id:"2",style:{width:"600px",height:"400px"},ref:n})]})},K=()=>{let e=(0,o.useSearchParams)().get("modal"),t=(0,o.useRouter)(),[r,i]=(0,a.useState)(!1),[l,c]=(0,a.useState)("random"),[u,d]=(0,a.useState)("10"),[h,f]=(0,a.useState)(void 0),m="random"===l,p=(0,a.useMemo)(()=>m?Array(+u).fill(null).map((e,t)=>{let r=new(L());return r.id=t,r}):[],[u,m]),[x,T]=(0,a.useState)([]),[b,R]=(0,a.useState)([]),[w,y]=(0,a.useState)([]),[v,k]=(0,a.useState)([]),[M,j]=(0,a.useState)([]),[g,S]=(0,a.useState)([]),[F,P]=(0,a.useState)([]),[N,E]=(0,a.useState)([]),D=(0,a.useMemo)(()=>{let e=x.concat(b,w,v).sort((e,t)=>e[0]-t[0]);return v.length>1e3&&console.log(v[v.length-1]),console.warn=()=>null,e.unshift(["Orginal Tasks Num","Excuted Tasks Num","Method"]),e},[x,b,w,v]),I=(0,a.useMemo)(()=>{let e=M.concat(g,F,N).sort((e,t)=>e[0]-t[0]);return e.unshift(["Orginal Tasks Num","PoF","Method"]),e},[M,g,F,N]),_=m?p:h;return(0,a.useEffect)(()=>{"alg"===e?document.body.style.overflow="hidden":document.body.style.overflow="scroll",i("alg"===e)},[e]),(0,s.jsxs)("div",{className:"jsx-b405a942a315b0a0",children:[r&&(0,s.jsx)("div",{onClick:function(){t.replace("/")},className:"jsx-b405a942a315b0a0 modal",children:(0,s.jsxs)("div",{onClick:function(e){e.stopPropagation()},className:"jsx-b405a942a315b0a0 modal-content",children:[(0,s.jsx)(Z,{selected:l,setSelected:c,taskLen:u,setTaskLen:d,graphData:h,setGraphData:f,randomTask:p}),(0,s.jsx)("div",{className:"jsx-b405a942a315b0a0 pl-[10%] pt-20",children:(0,s.jsx)(C,{})}),(0,s.jsx)(A,{AppBeTest:_,isRandomData:m,setTMRExcutedNumsComp:T,setTMRExcutedPofComp:j}),(0,s.jsx)("div",{className:"jsx-b405a942a315b0a0 border-t-2 border-gray-200 mt-10"}),(0,s.jsx)(z,{AppBeTest:_,isRandomData:m,setTPTMRexcutedNumsComp:R,setTPTMRexcutedPofComp:S}),(0,s.jsx)("div",{className:"jsx-b405a942a315b0a0 border-t-2 border-gray-200 mt-10"}),(0,s.jsx)(O,{AppBeTest:_,isRandomData:m,setRTMRexcutedNumsComp:y,setRTMRexcutedPofComp:P}),(0,s.jsx)("div",{className:"jsx-b405a942a315b0a0 border-t-2 border-gray-200 mt-10"}),(0,s.jsx)(J,{taskNumExperimentData:D,taskPofExperimentData:I})]})}),(0,s.jsx)(n(),{id:"b405a942a315b0a0",children:".modal.jsx-b405a942a315b0a0{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.modal-content.jsx-b405a942a315b0a0{background:white;height:40rem;padding:2rem;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;overflow:scroll}"})]})}},8995:(e,t,r)=>{Promise.resolve().then(r.bind(r,8144))},9188:(e,t,r)=>{"use strict";let{calProbability:s,hitProbability:i}=r(3481),n=0;class a{constructor(){this.id=n++,this.duration=2*Math.random(),this.transientFaultProbality=s(this.duration)+.05}}e.exports=a}},e=>{var t=t=>e(e.s=t);e.O(0,[693,441,684,358],()=>t(8995)),_N_E=e.O()}]);